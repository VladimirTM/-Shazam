import numpy as np
from scipy.fftpack import fft, fftfreq
import matplotlib.pyplot as plt

FFT_SIZE = 1024

def try_find_peaks (data, number_of_peaks_to_find, iteration_count = 0):
    if(len(data) <= number_of_peaks_to_find):
        return data;

        
    data_length = len(data);

    if(iteration_count == 0):
        min_max_pairs = [];
        data = data[0:data_length//2]
        data_length = len(data)
        for index in range(0, data_length - 1, 2):
            min_ = None
            max_ = None
            if(index != data_length - 2):
                max_ = max([data[index], data[index + 1]]);
                min_ = min([data[index], data[index + 1]]);
            else:
                max_ = data[index];
                min_ = data[index];
            min_max_pairs.append([max_, min_]);
        
        return try_find_peaks(min_max_pairs, number_of_peaks_to_find, iteration_count + 1)
    else:
        min_max_pairs = [];
        for index in range (0, data_length - 1, 2):
            if(index == data_length):
                min_max_pairs.append([data[index], data[index]])
            else:
                pair_1 = data[index]
                pair_2 = data[data_length - index - 1]
                
                pair_1_max = pair_1[0];
                pair_1_min = pair_1[1];

                pair_2_max = pair_2[0];
                pair_2_min = pair_2[1];

                min_ = None;
                max_ = None
                if(min([pair_1_max, pair_2_max]) < max(pair_1_min, pair_2_min)):
                    # downword slope, modify
                    min_ = min(pair_1_min, pair_2_min)
                else: min_ = max(pair_1_min, pair_2_min)

                max_ = max(pair_1_max, pair_2_max)
                min_max_pairs.append([max_, min_])
        return try_find_peaks(min_max_pairs, number_of_peaks_to_find, iteration_count + 1)


def make_FFT (samples, sampling_rate):
    y = fft(samples, FFT_SIZE)
    x = fftfreq(1024, 1/sampling_rate)[:FFT_SIZE//2]
    magnitude = 2.0 / FFT_SIZE * np.abs(y[:FFT_SIZE // 2])
    return magnitude, x

def plot_FFT(magnitudes, x):
    plt.xlabel("Frequency (Hz)")
    plt.plot(x, magnitudes, label="Spectrum")
    detected_maximas = np.array(list(map(lambda x: x[0], try_find_peaks(magnitudes, 16))))
    plt.scatter(np.array(list(map(lambda val: x[list(magnitudes).index(val)], detected_maximas))), list(map(lambda x: x, detected_maximas)), color="y", zorder=10, label="My Marker")
    plt.show()
    return list(map(lambda val: x[list(magnitudes).index(val)], detected_maximas))

samples_floats = [0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,-0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068]
samples_signed_ints = [0,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,  -1,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608]
SAMPLING_RATE = 10_000


arduino_samples_barely_holdin_on = [136,135,131,127,124,124,126,130,129,124,120,120,124,128,130,129,128,127,128,128,129,132,133,131,125,117,113,115,121,129,132,132,130,129,129,129,127,124,123,125,128,129,126,125,128,132,132,128,125,124,127,129,129,126,122,121,122,123,123,123,125,130,136,138,134,128,123,121,122,122,120,119,119,124,128,131,131,132,131,129,125,121,120,123,127,128,128,126,124,125,129,133,133,130,128,126,125,125,123,121,119,117,118,122,129,136,142,142,136,127,120,118,122,125,125,122,121,122,126,130,132,130,128,128,128,128,126,126,129,130,128,122,117,118,123,133,138,135,130,126,127,128,127,123,120,119,122,125,128,129,132,133,135,131,126,120,122,128,131,129,123,122,123,125,126,125,125,125,128,130,130,128,127,128,128,128,125,122,124,129,133,134,132,129,128,128,126,122,119,119,124,131,132,129,124,125,126,128,129,129,128,126,125,125,125,126,125,124,122,121,123,126,131,134,136,133,126,118,116,119,126,132,132,129,129,129,130,130,130,128,124,120,119,122,125,129,130,128,122,118,118,124,132,138,137,132,126,123,123,124,125,123,120,120,121,126,129,133,135,133,127,120,117,119,126,134,134,129,122,122,124,128,128,127,126,126,128,129,131,132,131,128,123,118,117,118,124,130,134,134,131,128,128,126,125,124,125,125,125,126,128,128,126,124,123,124,124,126,129,131,133,133,132,129,126,124,124,125,126,129,131,132,131,128,125,122,121,122,128,126,128,131,131,130,128,125,122,122,125,131,133,132,130,126,124,122,125,131,137,136,131,126,124,126,127,126,122,118,118,120,125,132,138,142,140,132,123,119,120,125,130,131,128,124,121,124,129,132,131,128,125,125,128,130,133,134,132,128,119,115,118,125,135,138,134,129,125,126,128,129,129,127,124,121,120,123,128,133,132,129,125,123,125,128,133,135,132,126,120,117,120,125,127,126,125,125,128,130,132,132,132,129,126,124,124,127,129,131,130,128,126,124,125,127,128,127,124,124,125,127,128,125,122,122,126,129,131,132,130,129,127,125,123,122,123,126,126,127,128,130,133,133,129,124,121,120,124,129,134,133,130,128,127,128,128,130,130,129,128,127,125,123,124,125,125,122,120,122,127,134,139,139,136,130,126,123,121,122,124,125,126,126,126,126,129,133,135,133,128,123,122,126,132,135,132,127,121,118,121,127,133,136,136,133,130,128,126,128,127,125,123,119,117,121,130,138,140,134,128,125,126,128,129,129,128,127,125,123,122,123,125,128,131,129,128,128,131,135,136,133,128,123,121,124,128,128,130,132,133,130,127,123,124,125,126,127,126,125,124,127,129,128,125,124,128,132]
magnitudes, x = make_FFT(arduino_samples_barely_holdin_on, SAMPLING_RATE)
max_frequencies_normal_fft = plot_FFT(magnitudes, x)
print(max_frequencies_normal_fft)

verilog_magnitudes = [132152.000000,1608.815713,385.331027,380.063153,320.000000,151.789328,258.487911,64.000000,160.000000,113.701363,75.471849,116.481758,17.888544,106.733313,78.790862,64.498062,100.239713,28.844410,104.000000,17.888544,32.984845,121.852370,80.000000,118.928550,129.243955,86.162637,8.000000,50.596443,57.688820,67.882251,43.081318,97.652445,128.996124,16.000000,28.844410,90.509668,71.554175,57.688820,24.000000,53.665631,64.498062,35.777088,75.894664,128.249756,317.590932,186.761880,128.996124,174.722637,35.777088,62.481997,56.568542,50.596443,16.000000,32.000000,0.000000,72.443081,105.223572,11.313708,11.313708,283.068896,425.205833,294.373912,107.628992,161.789987,73.756356,286.440221,57.688820,702.771656,701.313054,224.142812,397.190131,251.077677,219.672483,114.542569,80.399005,161.987654,141.760361,48.662100,57.688820,17.888544,40.000000,51.224994,28.844410,57.688820,68.818602,17.888544,89.442719,143.108351,163.168624,171.207476,105.223572,129.243955,149.452334,221.269067,116.481758,565.685425,897.748294,481.331487,24.000000,108.811764,171.020467,35.777088,48.662100,104.307238,120.000000,121.061968,64.498062,98.954535,35.777088,46.647615,80.000000,78.790862,53.665631,82.365041,40.000000,33.941125,65.969690,48.662100,17.888544,67.882251,62.481997,33.941125,73.756356,128.996124,75.894664,68.352030,82.365041,164.924225,53.665631,136.937942,79.195959,168.760185,313.738745,363.890093,198.070694,677.170584,482.394030,182.428068,280.456770,510.560476,417.382319,163.168624,339.411255,486.686758,363.626182,166.469216,72.443081,108.811764,101.192885,102.449988,32.984845,118.928550,53.665631,58.240879,16.000000,48.000000,32.984845,78.790862,16.000000,40.000000,40.792156,25.298221,24.000000,25.298221,17.888544,40.792156,64.498062,83.522452,51.224994,58.240879,28.844410,11.313708,25.298221,48.662100,40.000000,64.498062,25.298221,85.041167,32.984845,112.000000,249.158584,147.078210,301.569229,387.071053,118.118584,143.108351,97.652445,113.701363,33.941125,32.000000,102.449988,46.647615,147.512711,93.295230,32.984845,48.662100,40.000000,32.984845,24.000000,11.313708,8.000000,17.888544,48.000000,25.298221,8.000000,32.984845,25.298221,33.941125,48.662100,56.568542,62.481997,33.941125,40.000000,68.818602,48.000000,51.224994,25.298221,32.000000,28.844410,32.984845,24.000000,16.000000,8.000000,32.984845,28.844410,11.313708,8.000000,17.888544,11.313708,32.984845,32.984845,11.313708,0.000000,17.888544,16.000000,8.000000,32.000000,25.298221,16.000000,16.000000,16.000000,8.000000,17.888544,46.647615,50.596443,8.000000,35.777088,16.000000,28.844410,16.000000,25.298221,8.000000,17.888544,17.888544,28.844410,17.888544,8.000000,25.298221,25.298221,17.888544,25.298221,17.888544,25.298221,17.888544,17.888544,16.000000,17.888544,16.000000,8.000000,11.313708,8.000000,0.000000,28.844410,17.888544,11.313708,28.844410,11.313708,8.000000,16.000000,25.298221,8.000000,8.000000,22.627417,22.627417,11.313708,22.627417,8.000000,16.000000,17.888544,8.000000,8.000000,8.000000,11.313708,16.000000,17.888544,17.888544,8.000000,8.000000,17.888544,8.000000,22.627417,17.888544,0.000000,11.313708,0.000000,8.000000,8.000000,17.888544,11.313708,11.313708,17.888544,17.888544,8.000000,16.000000,11.313708,11.313708,17.888544,17.888544,0.000000,11.313708,8.000000,8.000000,22.627417,17.888544,0.000000,0.000000,8.000000,8.000000,11.313708,17.888544,8.000000,8.000000,8.000000,8.000000,16.000000,8.000000,11.313708,11.313708,17.888544,0.000000,16.000000,11.313708,28.844410,16.000000,8.000000,8.000000,11.313708,16.000000,8.000000,8.000000,17.888544,22.627417,0.000000,17.888544,16.000000,8.000000,0.000000,17.888544,17.888544,8.000000,0.000000,11.313708,8.000000,25.298221,24.000000,11.313708,16.000000,22.627417,17.888544,17.888544,8.000000,8.000000,11.313708,8.000000,11.313708,8.000000,11.313708,8.000000,0.000000,0.000000,8.000000,8.000000,16.000000,8.000000,11.313708,8.000000,8.000000,8.000000,8.000000,11.313708,8.000000,8.000000,16.000000,8.000000,22.627417,28.844410,0.000000,11.313708,17.888544,11.313708,11.313708,8.000000,0.000000,8.000000,8.000000,8.000000,11.313708,11.313708,11.313708,11.313708,17.888544,24.000000,0.000000,8.000000,0.000000,8.000000,17.888544,8.000000,8.000000,11.313708,8.000000,0.000000,8.000000,8.000000,0.000000,11.313708,28.844410,28.844410,16.000000,8.000000,16.000000,17.888544,8.000000,11.313708,0.000000,17.888544,8.000000,11.313708,8.000000,0.000000,0.000000,17.888544,16.000000,8.000000,11.313708,11.313708,8.000000,17.888544,17.888544,17.888544,28.844410,17.888544,8.000000,8.000000,25.298221,22.627417,17.888544,8.000000,8.000000,11.313708,16.000000,0.000000,8.000000,17.888544,8.000000,16.000000,11.313708,11.313708,8.000000,16.000000,16.000000,8.000000,17.888544,8.000000,11.313708,8.000000,0.000000,11.313708,8.000000,17.888544,8.000000,25.298221,17.888544,16.000000,17.888544,11.313708,16.000000,8.000000,8.000000,8.000000,16.000000,8.000000,0.000000,8.000000,17.888544,17.888544,17.888544,17.888544,11.313708,0.000000,17.888544,11.313708,8.000000,0.000000,8.000000,8.000000,16.000000,17.888544,11.313708,8.000000,0.000000,17.888544,8.000000,8.000000,8.000000,0.000000,11.313708,11.313708,11.313708,17.888544,11.313708,8.000000,8.000000,11.313708,11.313708,0.000000,11.313708,24.000000,8.000000,11.313708,11.313708,8.000000,8.000000,0.000000,17.888544,11.313708,8.000000,8.000000,8.000000,0.000000,11.313708,24.000000,17.888544,17.888544,8.000000,11.313708,0.000000,0.000000,8.000000,8.000000,8.000000,0.000000,11.313708,8.000000,8.000000,8.000000,0.000000,0.000000,0.000000,8.000000,11.313708,8.000000,11.313708,11.313708,8.000000,8.000000,8.000000,0.000000,11.313708,17.888544,17.888544,8.000000,16.000000,17.888544,25.298221,17.888544,11.313708,17.888544,8.000000,8.000000,17.888544,11.313708,17.888544,8.000000,8.000000,0.000000,11.313708,11.313708,8.000000,8.000000,0.000000,8.000000,11.313708,17.888544,17.888544,8.000000,17.888544,22.627417,22.627417,17.888544,0.000000,8.000000,11.313708,0.000000,8.000000,0.000000,0.000000,16.000000,16.000000,8.000000,8.000000,8.000000,0.000000,24.000000,11.313708,11.313708,11.313708,8.000000,8.000000,0.000000,0.000000,11.313708,8.000000,0.000000,8.000000,24.000000,8.000000,8.000000,8.000000,17.888544,22.627417,0.000000,11.313708,11.313708,0.000000,17.888544,8.000000,8.000000,16.000000,8.000000,8.000000,17.888544,16.000000,11.313708,11.313708,0.000000,0.000000,16.000000,8.000000,11.313708,11.313708,17.888544,0.000000,0.000000,8.000000,8.000000,17.888544,28.844410,16.000000,16.000000,25.298221,16.000000,11.313708,11.313708,8.000000,0.000000,16.000000,17.888544,8.000000,11.313708,17.888544,8.000000,8.000000,17.888544,11.313708,8.000000,0.000000,11.313708,17.888544,0.000000,0.000000,25.298221,28.844410,8.000000,16.000000,8.000000,11.313708,11.313708,11.313708,11.313708,8.000000,8.000000,0.000000,8.000000,0.000000,8.000000,8.000000,0.000000,0.000000,8.000000,8.000000,17.888544,11.313708,8.000000,0.000000,8.000000,8.000000,17.888544,17.888544,11.313708,16.000000,8.000000,0.000000,17.888544,16.000000,17.888544,16.000000,8.000000,0.000000,0.000000,8.000000,8.000000,8.000000,16.000000,11.313708,11.313708,8.000000,8.000000,0.000000,17.888544,11.313708,11.313708,8.000000,11.313708,8.000000,8.000000,11.313708,16.000000,8.000000,17.888544,11.313708,22.627417,17.888544,11.313708,8.000000,16.000000,25.298221,8.000000,17.888544,22.627417,8.000000,17.888544,28.844410,11.313708,8.000000,8.000000,8.000000,11.313708,11.313708,24.000000,17.888544,8.000000,24.000000,28.844410,16.000000,16.000000,17.888544,17.888544,0.000000,25.298221,25.298221,28.844410,8.000000,11.313708,22.627417,17.888544,28.844410,11.313708,46.647615,16.000000,50.596443,35.777088,8.000000,17.888544,11.313708,8.000000,11.313708,17.888544,16.000000,8.000000,22.627417,11.313708,11.313708,8.000000,28.844410,35.777088,8.000000,28.844410,0.000000,16.000000,28.844410,40.792156,0.000000,11.313708,25.298221,40.000000,35.777088,25.298221,22.627417,40.000000,48.662100,62.481997,32.984845,40.000000,51.224994,51.224994,56.000000,22.627417,22.627417,25.298221,8.000000,28.844410,48.662100,16.000000,8.000000,16.000000,28.844410,24.000000,48.662100,40.000000,24.000000,93.295230,141.760361,35.777088,97.652445,25.298221,28.844410,118.928550,93.295230,129.243955,107.331263,379.473319,301.569229,147.512711,254.621287,104.307238,25.298221,80.000000,32.984845,71.554175,62.481997,56.568542,28.844410,16.000000,33.941125,56.568542,46.647615,83.522452,62.481997,40.000000,11.313708,8.000000,17.888544,16.000000,32.984845,32.000000,17.888544,60.926185,48.000000,48.662100,25.298221,58.240879,60.926185,111.427106,40.000000,96.332757,100.239713,104.000000,81.584312,161.987654,357.502448,490.159158,345.114474,161.789987,419.141981,508.802516,288.998270,166.469216,466.476152,686.929400,198.070694,368.347662,309.011327,164.730082,90.509668,144.886162,46.647615,178.885438,96.664368,64.498062,82.365041,132.423563,71.554175,17.888544,71.554175,56.568542,24.000000,64.498062,56.568542,51.224994,40.000000,91.214034,43.081318,80.000000,62.481997,40.000000,25.298221,89.442719,60.926185,120.266371,118.928550,88.000000,35.777088,40.000000,161.789987,107.331263,32.984845,465.927033,905.273439,580.482558,126.491106,215.406592,161.987654,125.219807,114.542569,155.331903,172.696265,150.306354,72.443081,28.844410,73.756356,53.665631,32.984845,53.665631,22.627417,28.844410,60.926185,32.984845,151.789328,157.581725,80.000000,111.139552,218.357505,236.237169,379.473319,208.000000,689.301095,716.435622,68.352030,308.804145,67.882251,171.020467,104.307238,288.555021,411.358724,299.866637,25.298221,28.844410,116.481758,88.000000,17.888544,40.792156,28.844410,64.000000,68.352030,79.195959,40.792156,194.812731,153.883072,203.960781,322.490310,112.000000,81.584312,46.647615,58.240879,64.498062,22.627417,62.481997,73.756356,97.652445,32.984845,25.298221,144.000000,73.756356,48.662100,78.790862,65.969690,64.498062,16.000000,89.442719,118.118584,147.078210,91.214034,139.713994,53.665631,35.777088,128.996124,45.254834,118.928550,86.533231,67.882251,126.491106,16.000000,128.996124,97.652445,124.963995,188.806780,46.647615,286.775173,187.275199,330.720426,408.705273,385.331027,1636.151582]
verilog_magnitudes = verilog_magnitudes[:FFT_SIZE//2]
x = fftfreq(1024, 1/SAMPLING_RATE)[:FFT_SIZE//2]

max_frequencies_verilog_fft = plot_FFT(verilog_magnitudes, x);
print(max_frequencies_verilog_fft)

import numpy as np
from scipy.fftpack import fft, fftfreq
import matplotlib.pyplot as plt

FFT_SIZE = 1024

def try_find_peaks (data, number_of_peaks_to_find, iteration_count = 0):
    if(len(data) <= number_of_peaks_to_find):
        return data;

        
    data_length = len(data);

    if(iteration_count == 0):
        min_max_pairs = [];
        data = data[0:data_length//2]
        data_length = len(data)
        for index in range(0, data_length - 1, 2):
            min_ = None
            max_ = None
            if(index != data_length - 2):
                max_ = max([data[index], data[index + 1]]);
                min_ = min([data[index], data[index + 1]]);
            else:
                max_ = data[index];
                min_ = data[index];
            min_max_pairs.append([max_, min_]);
        
        return try_find_peaks(min_max_pairs, number_of_peaks_to_find, iteration_count + 1)
    else:
        min_max_pairs = [];
        for index in range (0, data_length - 1, 2):
            if(index == data_length):
                min_max_pairs.append([data[index], data[index]])
            else:
                pair_1 = data[index]
                pair_2 = data[data_length - index - 1]
                
                pair_1_max = pair_1[0];
                pair_1_min = pair_1[1];

                pair_2_max = pair_2[0];
                pair_2_min = pair_2[1];

                min_ = None;
                max_ = None
                if(min([pair_1_max, pair_2_max]) < max(pair_1_min, pair_2_min)):
                    # downword slope, modify
                    min_ = min(pair_1_min, pair_2_min)
                else: min_ = max(pair_1_min, pair_2_min)

                max_ = max(pair_1_max, pair_2_max)
                min_max_pairs.append([max_, min_])
        return try_find_peaks(min_max_pairs, number_of_peaks_to_find, iteration_count + 1)


def make_FFT (samples, sampling_rate):
    y = fft(samples, FFT_SIZE)
    x = fftfreq(1024, 1/sampling_rate)[:FFT_SIZE//2]
    magnitude = 2.0 / FFT_SIZE * np.abs(y[:FFT_SIZE // 2])
    return magnitude, x

def plot_FFT(magnitudes, x, title):
    plt.xlabel("Frequency (Hz)")
    plt.title(title)
    plt.plot(x, magnitudes, label="Spectrum")
    detected_maximas = np.array(list(map(lambda x: x[0], try_find_peaks(magnitudes, 16))))
    plt.scatter(np.array(list(map(lambda val: x[list(magnitudes).index(val)], detected_maximas))), list(map(lambda x: x, detected_maximas)), color="y", zorder=10, label="My Marker")
    plt.show()
    return list(map(lambda val: x[list(magnitudes).index(val)], detected_maximas))

samples_floats = [0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,-0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068,-0.000000,0.049068,0.098017,0.146730,0.195090,0.242980,0.290285,0.336890,0.382683,0.427555,0.471397,0.514103,0.555570,0.595699,0.634393,0.671559,0.707107,0.740951,0.773010,0.803208,0.831470,0.857729,0.881921,0.903989,0.923880,0.941544,0.956940,0.970031,0.980785,0.989177,0.995185,0.998795,1.000000,0.998795,0.995185,0.989177,0.980785,0.970031,0.956940,0.941544,0.923880,0.903989,0.881921,0.857729,0.831470,0.803208,0.773010,0.740951,0.707107,0.671559,0.634393,0.595699,0.555570,0.514103,0.471397,0.427555,0.382683,0.336890,0.290285,0.242980,0.195090,0.146730,0.098017,0.049068,0.000000,-0.049068,-0.098017,-0.146730,-0.195090,-0.242980,-0.290285,-0.336890,-0.382683,-0.427555,-0.471397,-0.514103,-0.555570,-0.595699,-0.634393,-0.671559,-0.707107,-0.740951,-0.773010,-0.803208,-0.831470,-0.857729,-0.881921,-0.903989,-0.923880,-0.941544,-0.956940,-0.970031,-0.980785,-0.989177,-0.995185,-0.998795,-1.000000,-0.998795,-0.995185,-0.989177,-0.980785,-0.970031,-0.956940,-0.941544,-0.923880,-0.903989,-0.881921,-0.857729,-0.831470,-0.803208,-0.773010,-0.740951,-0.707107,-0.671559,-0.634393,-0.595699,-0.555570,-0.514103,-0.471397,-0.427555,-0.382683,-0.336890,-0.290285,-0.242980,-0.195090,-0.146730,-0.098017,-0.049068]
samples_signed_ints = [0,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,  -1,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608,  -1,1607,3211,4808,6392,7961,9512,11039,12539,14010,15446,16846,18204,19519,20787,22005,23170,24279,25330,26319,27245,28106,28898,29621,30273,30852,31357,31785,32138,32413,32610,32728,32767,32728,32610,32413,32138,31785,31357,30852,30273,29621,28898,28106,27245,26319,25330,24279,23170,22005,20787,19519,18204,16846,15446,14010,12539,11039,9512,7961,6392,4808,3211,1607,   0,-1608,-3212,-4809,-6393,-7962,-9513,-11040,-12540,-14011,-15447,-16847,-18205,-19520,-20788,-22006,-23171,-24280,-25331,-26320,-27246,-28107,-28899,-29622,-30274,-30853,-31358,-31786,-32139,-32414,-32611,-32729,-32768,-32729,-32611,-32414,-32139,-31786,-31358,-30853,-30274,-29622,-28899,-28107,-27246,-26320,-25331,-24280,-23171,-22006,-20788,-19520,-18205,-16847,-15447,-14011,-12540,-11040,-9513,-7962,-6393,-4809,-3212,-1608]
SAMPLING_RATE = 10_000


arduino_samples_barely_holdin_on = [136,135,131,127,124,124,126,130,129,124,120,120,124,128,130,129,128,127,128,128,129,132,133,131,125,117,113,115,121,129,132,132,130,129,129,129,127,124,123,125,128,129,126,125,128,132,132,128,125,124,127,129,129,126,122,121,122,123,123,123,125,130,136,138,134,128,123,121,122,122,120,119,119,124,128,131,131,132,131,129,125,121,120,123,127,128,128,126,124,125,129,133,133,130,128,126,125,125,123,121,119,117,118,122,129,136,142,142,136,127,120,118,122,125,125,122,121,122,126,130,132,130,128,128,128,128,126,126,129,130,128,122,117,118,123,133,138,135,130,126,127,128,127,123,120,119,122,125,128,129,132,133,135,131,126,120,122,128,131,129,123,122,123,125,126,125,125,125,128,130,130,128,127,128,128,128,125,122,124,129,133,134,132,129,128,128,126,122,119,119,124,131,132,129,124,125,126,128,129,129,128,126,125,125,125,126,125,124,122,121,123,126,131,134,136,133,126,118,116,119,126,132,132,129,129,129,130,130,130,128,124,120,119,122,125,129,130,128,122,118,118,124,132,138,137,132,126,123,123,124,125,123,120,120,121,126,129,133,135,133,127,120,117,119,126,134,134,129,122,122,124,128,128,127,126,126,128,129,131,132,131,128,123,118,117,118,124,130,134,134,131,128,128,126,125,124,125,125,125,126,128,128,126,124,123,124,124,126,129,131,133,133,132,129,126,124,124,125,126,129,131,132,131,128,125,122,121,122,128,126,128,131,131,130,128,125,122,122,125,131,133,132,130,126,124,122,125,131,137,136,131,126,124,126,127,126,122,118,118,120,125,132,138,142,140,132,123,119,120,125,130,131,128,124,121,124,129,132,131,128,125,125,128,130,133,134,132,128,119,115,118,125,135,138,134,129,125,126,128,129,129,127,124,121,120,123,128,133,132,129,125,123,125,128,133,135,132,126,120,117,120,125,127,126,125,125,128,130,132,132,132,129,126,124,124,127,129,131,130,128,126,124,125,127,128,127,124,124,125,127,128,125,122,122,126,129,131,132,130,129,127,125,123,122,123,126,126,127,128,130,133,133,129,124,121,120,124,129,134,133,130,128,127,128,128,130,130,129,128,127,125,123,124,125,125,122,120,122,127,134,139,139,136,130,126,123,121,122,124,125,126,126,126,126,129,133,135,133,128,123,122,126,132,135,132,127,121,118,121,127,133,136,136,133,130,128,126,128,127,125,123,119,117,121,130,138,140,134,128,125,126,128,129,129,128,127,125,123,122,123,125,128,131,129,128,128,131,135,136,133,128,123,121,124,128,128,130,132,133,130,127,123,124,125,126,127,126,125,124,127,129,128,125,124,128,132]
magnitudes, x = make_FFT(arduino_samples_barely_holdin_on, SAMPLING_RATE)
max_frequencies_normal_fft = plot_FFT(magnitudes, x, "PYTHON FFT")
print("MAX FREQUENCIES DETECTED BY NORMAL FFT:", max_frequencies_normal_fft)

verilog_magnitudes = [132152.000000,1608.815713,385.331027,380.063153,320.000000,151.789328,258.487911,64.000000,160.000000,113.701363,75.471849,116.481758,17.888544,106.733313,78.790862,64.498062,100.239713,28.844410,104.000000,17.888544,32.984845,121.852370,80.000000,118.928550,129.243955,86.162637,8.000000,50.596443,57.688820,67.882251,43.081318,97.652445,128.996124,16.000000,28.844410,90.509668,71.554175,57.688820,24.000000,53.665631,64.498062,35.777088,75.894664,128.249756,317.590932,186.761880,128.996124,174.722637,35.777088,62.481997,56.568542,50.596443,16.000000,32.000000,0.000000,72.443081,105.223572,11.313708,11.313708,283.068896,425.205833,294.373912,107.628992,161.789987,73.756356,286.440221,57.688820,702.771656,701.313054,224.142812,397.190131,251.077677,219.672483,114.542569,80.399005,161.987654,141.760361,48.662100,57.688820,17.888544,40.000000,51.224994,28.844410,57.688820,68.818602,17.888544,89.442719,143.108351,163.168624,171.207476,105.223572,129.243955,149.452334,221.269067,116.481758,565.685425,897.748294,481.331487,24.000000,108.811764,171.020467,35.777088,48.662100,104.307238,120.000000,121.061968,64.498062,98.954535,35.777088,46.647615,80.000000,78.790862,53.665631,82.365041,40.000000,33.941125,65.969690,48.662100,17.888544,67.882251,62.481997,33.941125,73.756356,128.996124,75.894664,68.352030,82.365041,164.924225,53.665631,136.937942,79.195959,168.760185,313.738745,363.890093,198.070694,677.170584,482.394030,182.428068,280.456770,510.560476,417.382319,163.168624,339.411255,486.686758,363.626182,166.469216,72.443081,108.811764,101.192885,102.449988,32.984845,118.928550,53.665631,58.240879,16.000000,48.000000,32.984845,78.790862,16.000000,40.000000,40.792156,25.298221,24.000000,25.298221,17.888544,40.792156,64.498062,83.522452,51.224994,58.240879,28.844410,11.313708,25.298221,48.662100,40.000000,64.498062,25.298221,85.041167,32.984845,112.000000,249.158584,147.078210,301.569229,387.071053,118.118584,143.108351,97.652445,113.701363,33.941125,32.000000,102.449988,46.647615,147.512711,93.295230,32.984845,48.662100,40.000000,32.984845,24.000000,11.313708,8.000000,17.888544,48.000000,25.298221,8.000000,32.984845,25.298221,33.941125,48.662100,56.568542,62.481997,33.941125,40.000000,68.818602,48.000000,51.224994,25.298221,32.000000,28.844410,32.984845,24.000000,16.000000,8.000000,32.984845,28.844410,11.313708,8.000000,17.888544,11.313708,32.984845,32.984845,11.313708,0.000000,17.888544,16.000000,8.000000,32.000000,25.298221,16.000000,16.000000,16.000000,8.000000,17.888544,46.647615,50.596443,8.000000,35.777088,16.000000,28.844410,16.000000,25.298221,8.000000,17.888544,17.888544,28.844410,17.888544,8.000000,25.298221,25.298221,17.888544,25.298221,17.888544,25.298221,17.888544,17.888544,16.000000,17.888544,16.000000,8.000000,11.313708,8.000000,0.000000,28.844410,17.888544,11.313708,28.844410,11.313708,8.000000,16.000000,25.298221,8.000000,8.000000,22.627417,22.627417,11.313708,22.627417,8.000000,16.000000,17.888544,8.000000,8.000000,8.000000,11.313708,16.000000,17.888544,17.888544,8.000000,8.000000,17.888544,8.000000,22.627417,17.888544,0.000000,11.313708,0.000000,8.000000,8.000000,17.888544,11.313708,11.313708,17.888544,17.888544,8.000000,16.000000,11.313708,11.313708,17.888544,17.888544,0.000000,11.313708,8.000000,8.000000,22.627417,17.888544,0.000000,0.000000,8.000000,8.000000,11.313708,17.888544,8.000000,8.000000,8.000000,8.000000,16.000000,8.000000,11.313708,11.313708,17.888544,0.000000,16.000000,11.313708,28.844410,16.000000,8.000000,8.000000,11.313708,16.000000,8.000000,8.000000,17.888544,22.627417,0.000000,17.888544,16.000000,8.000000,0.000000,17.888544,17.888544,8.000000,0.000000,11.313708,8.000000,25.298221,24.000000,11.313708,16.000000,22.627417,17.888544,17.888544,8.000000,8.000000,11.313708,8.000000,11.313708,8.000000,11.313708,8.000000,0.000000,0.000000,8.000000,8.000000,16.000000,8.000000,11.313708,8.000000,8.000000,8.000000,8.000000,11.313708,8.000000,8.000000,16.000000,8.000000,22.627417,28.844410,0.000000,11.313708,17.888544,11.313708,11.313708,8.000000,0.000000,8.000000,8.000000,8.000000,11.313708,11.313708,11.313708,11.313708,17.888544,24.000000,0.000000,8.000000,0.000000,8.000000,17.888544,8.000000,8.000000,11.313708,8.000000,0.000000,8.000000,8.000000,0.000000,11.313708,28.844410,28.844410,16.000000,8.000000,16.000000,17.888544,8.000000,11.313708,0.000000,17.888544,8.000000,11.313708,8.000000,0.000000,0.000000,17.888544,16.000000,8.000000,11.313708,11.313708,8.000000,17.888544,17.888544,17.888544,28.844410,17.888544,8.000000,8.000000,25.298221,22.627417,17.888544,8.000000,8.000000,11.313708,16.000000,0.000000,8.000000,17.888544,8.000000,16.000000,11.313708,11.313708,8.000000,16.000000,16.000000,8.000000,17.888544,8.000000,11.313708,8.000000,0.000000,11.313708,8.000000,17.888544,8.000000,25.298221,17.888544,16.000000,17.888544,11.313708,16.000000,8.000000,8.000000,8.000000,16.000000,8.000000,0.000000,8.000000,17.888544,17.888544,17.888544,17.888544,11.313708,0.000000,17.888544,11.313708,8.000000,0.000000,8.000000,8.000000,16.000000,17.888544,11.313708,8.000000,0.000000,17.888544,8.000000,8.000000,8.000000,0.000000,11.313708,11.313708,11.313708,17.888544,11.313708,8.000000,8.000000,11.313708,11.313708,0.000000,11.313708,24.000000,8.000000,11.313708,11.313708,8.000000,8.000000,0.000000,17.888544,11.313708,8.000000,8.000000,8.000000,0.000000,11.313708,24.000000,17.888544,17.888544,8.000000,11.313708,0.000000,0.000000,8.000000,8.000000,8.000000,0.000000,11.313708,8.000000,8.000000,8.000000,0.000000,0.000000,0.000000,8.000000,11.313708,8.000000,11.313708,11.313708,8.000000,8.000000,8.000000,0.000000,11.313708,17.888544,17.888544,8.000000,16.000000,17.888544,25.298221,17.888544,11.313708,17.888544,8.000000,8.000000,17.888544,11.313708,17.888544,8.000000,8.000000,0.000000,11.313708,11.313708,8.000000,8.000000,0.000000,8.000000,11.313708,17.888544,17.888544,8.000000,17.888544,22.627417,22.627417,17.888544,0.000000,8.000000,11.313708,0.000000,8.000000,0.000000,0.000000,16.000000,16.000000,8.000000,8.000000,8.000000,0.000000,24.000000,11.313708,11.313708,11.313708,8.000000,8.000000,0.000000,0.000000,11.313708,8.000000,0.000000,8.000000,24.000000,8.000000,8.000000,8.000000,17.888544,22.627417,0.000000,11.313708,11.313708,0.000000,17.888544,8.000000,8.000000,16.000000,8.000000,8.000000,17.888544,16.000000,11.313708,11.313708,0.000000,0.000000,16.000000,8.000000,11.313708,11.313708,17.888544,0.000000,0.000000,8.000000,8.000000,17.888544,28.844410,16.000000,16.000000,25.298221,16.000000,11.313708,11.313708,8.000000,0.000000,16.000000,17.888544,8.000000,11.313708,17.888544,8.000000,8.000000,17.888544,11.313708,8.000000,0.000000,11.313708,17.888544,0.000000,0.000000,25.298221,28.844410,8.000000,16.000000,8.000000,11.313708,11.313708,11.313708,11.313708,8.000000,8.000000,0.000000,8.000000,0.000000,8.000000,8.000000,0.000000,0.000000,8.000000,8.000000,17.888544,11.313708,8.000000,0.000000,8.000000,8.000000,17.888544,17.888544,11.313708,16.000000,8.000000,0.000000,17.888544,16.000000,17.888544,16.000000,8.000000,0.000000,0.000000,8.000000,8.000000,8.000000,16.000000,11.313708,11.313708,8.000000,8.000000,0.000000,17.888544,11.313708,11.313708,8.000000,11.313708,8.000000,8.000000,11.313708,16.000000,8.000000,17.888544,11.313708,22.627417,17.888544,11.313708,8.000000,16.000000,25.298221,8.000000,17.888544,22.627417,8.000000,17.888544,28.844410,11.313708,8.000000,8.000000,8.000000,11.313708,11.313708,24.000000,17.888544,8.000000,24.000000,28.844410,16.000000,16.000000,17.888544,17.888544,0.000000,25.298221,25.298221,28.844410,8.000000,11.313708,22.627417,17.888544,28.844410,11.313708,46.647615,16.000000,50.596443,35.777088,8.000000,17.888544,11.313708,8.000000,11.313708,17.888544,16.000000,8.000000,22.627417,11.313708,11.313708,8.000000,28.844410,35.777088,8.000000,28.844410,0.000000,16.000000,28.844410,40.792156,0.000000,11.313708,25.298221,40.000000,35.777088,25.298221,22.627417,40.000000,48.662100,62.481997,32.984845,40.000000,51.224994,51.224994,56.000000,22.627417,22.627417,25.298221,8.000000,28.844410,48.662100,16.000000,8.000000,16.000000,28.844410,24.000000,48.662100,40.000000,24.000000,93.295230,141.760361,35.777088,97.652445,25.298221,28.844410,118.928550,93.295230,129.243955,107.331263,379.473319,301.569229,147.512711,254.621287,104.307238,25.298221,80.000000,32.984845,71.554175,62.481997,56.568542,28.844410,16.000000,33.941125,56.568542,46.647615,83.522452,62.481997,40.000000,11.313708,8.000000,17.888544,16.000000,32.984845,32.000000,17.888544,60.926185,48.000000,48.662100,25.298221,58.240879,60.926185,111.427106,40.000000,96.332757,100.239713,104.000000,81.584312,161.987654,357.502448,490.159158,345.114474,161.789987,419.141981,508.802516,288.998270,166.469216,466.476152,686.929400,198.070694,368.347662,309.011327,164.730082,90.509668,144.886162,46.647615,178.885438,96.664368,64.498062,82.365041,132.423563,71.554175,17.888544,71.554175,56.568542,24.000000,64.498062,56.568542,51.224994,40.000000,91.214034,43.081318,80.000000,62.481997,40.000000,25.298221,89.442719,60.926185,120.266371,118.928550,88.000000,35.777088,40.000000,161.789987,107.331263,32.984845,465.927033,905.273439,580.482558,126.491106,215.406592,161.987654,125.219807,114.542569,155.331903,172.696265,150.306354,72.443081,28.844410,73.756356,53.665631,32.984845,53.665631,22.627417,28.844410,60.926185,32.984845,151.789328,157.581725,80.000000,111.139552,218.357505,236.237169,379.473319,208.000000,689.301095,716.435622,68.352030,308.804145,67.882251,171.020467,104.307238,288.555021,411.358724,299.866637,25.298221,28.844410,116.481758,88.000000,17.888544,40.792156,28.844410,64.000000,68.352030,79.195959,40.792156,194.812731,153.883072,203.960781,322.490310,112.000000,81.584312,46.647615,58.240879,64.498062,22.627417,62.481997,73.756356,97.652445,32.984845,25.298221,144.000000,73.756356,48.662100,78.790862,65.969690,64.498062,16.000000,89.442719,118.118584,147.078210,91.214034,139.713994,53.665631,35.777088,128.996124,45.254834,118.928550,86.533231,67.882251,126.491106,16.000000,128.996124,97.652445,124.963995,188.806780,46.647615,286.775173,187.275199,330.720426,408.705273,385.331027,1636.151582]
verilog_magnitudes_hardcoded_bfpexp_minus_5 = [4095.875000,4095.875000,0.000000,0.000000,38.008634,38.008634,0.000000,0.000000,11.429813,11.429813,0.000000,0.000000,8.375933,8.375933,0.000000,0.000000,11.700694,11.700694,0.000000,0.000000,3.010399,3.010399,0.000000,0.000000,8.465001,8.465001,0.000000,0.000000,2.627975,2.627975,0.000000,0.000000,9.021675,9.021675,0.000000,0.000000,3.644345,3.644345,0.000000,0.000000,3.760402,3.760402,0.000000,0.000000,4.926015,4.926015,0.000000,0.000000,4.550069,4.550069,0.000000,0.000000,2.125000,2.125000,0.000000,0.000000,2.833946,2.833946,0.000000,0.000000,4.784415,4.784415,0.000000,0.000000,11.248611,11.248611,0.000000,0.000000,28.810263,28.810263,0.000000,0.000000,14.342354,14.342354,0.000000,0.000000,2.573908,2.573908,0.000000,0.000000,1.256234,1.256234,0.000000,0.000000,1.700184,1.700184,0.000000,0.000000,1.237437,1.237437,0.000000,0.000000,0.760345,0.760345,0.000000,0.000000,30.612753,30.612753,0.000000,0.000000,3.335416,3.335416,0.000000,0.000000,0.976281,0.976281,0.000000,0.000000,1.546165,1.546165,0.000000,0.000000,2.225562,2.225562,0.000000,0.000000,1.007782,1.007782,0.000000,0.000000,1.231107,1.231107,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,2.625000,2.625000,0.000000,0.000000,12.890161,12.890161,0.000000,0.000000,12.887130,12.887130,0.000000,0.000000,4.876602,4.876602,0.000000,0.000000,14.938415,14.938415,0.000000,0.000000,2.730041,2.730041,0.000000,0.000000,1.525819,1.525819,0.000000,0.000000,0.883883,0.883883,0.000000,0.000000,3.162278,3.162278,0.000000,0.000000,0.838525,0.838525,0.000000,0.000000,0.800391,0.800391,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,2.253470,2.253470,0.000000,0.000000,2.833946,2.833946,0.000000,0.000000,2.692582,2.692582,0.000000,0.000000,0.637377,0.637377,0.000000,0.000000,5.615269,5.615269,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.637377,0.637377,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.625000,0.625000,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.625000,0.625000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.800391,0.800391,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.559017,0.559017,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,1.414214,1.414214,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.800391,0.800391,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.530330,0.530330,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.500000,0.500000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.559017,0.559017,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.637377,0.637377,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.375000,0.375000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.530330,0.530330,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,1.007782,1.007782,0.000000,0.000000,0.790569,0.790569,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.530330,0.530330,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,2.885849,2.885849,0.000000,0.000000,0.790569,0.790569,0.000000,0.000000,2.490607,2.490607,0.000000,0.000000,1.328768,1.328768,0.000000,0.000000,1.068000,1.068000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.760345,0.760345,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,1.879162,1.879162,0.000000,0.000000,0.637377,0.637377,0.000000,0.000000,0.760345,0.760345,0.000000,0.000000,0.500000,0.500000,0.000000,0.000000,0.760345,0.760345,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,1.000000,1.000000,0.000000,0.000000,0.500000,0.500000,0.000000,0.000000,1.068000,1.068000,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,7.516648,7.516648,0.000000,0.000000,0.625000,0.625000,0.000000,0.000000,0.500000,0.500000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.875000,0.875000,0.000000,0.000000,0.728869,0.728869,0.000000,0.000000,1.305038,1.305038,0.000000,0.000000,1.741049,1.741049,0.000000,0.000000,0.500000,0.500000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.515388,0.515388,0.000000,0.000000,0.800391,0.800391,0.000000,0.000000,0.395285,0.395285,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.625000,0.625000,0.000000,0.000000,0.176777,0.176777,0.000000,0.000000,0.250000,0.250000,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.450694,0.450694,0.000000,0.000000,0.125000,0.125000,0.000000,0.000000,0.279508,0.279508,0.000000,0.000000,0.353553,0.353553,0.000000,0.000000]
verilog_magnitudes_hardcoded_bfpexp_4 = [264304.000000,3217.631427,770.662053,760.126305,640.000000,303.578655,516.975821,128.000000,320.000000,227.402726,150.943698,232.963516,35.777088,213.466625,157.581725,128.996124,200.479425,57.688820,208.000000,35.777088,65.969690,243.704739,160.000000,237.857100,258.487911,172.325274,16.000000,101.192885,115.377641,135.764502,86.162637,195.304890,257.992248,32.000000,57.688820,181.019336,143.108351,115.377641,48.000000,107.331263,128.996124,71.554175,151.789328,256.499513,635.181864,373.523761,257.992248,349.445275,71.554175,124.963995,113.137085,101.192885,32.000000,64.000000,0.000000,144.886162,210.447143,22.627417,22.627417,566.137792,850.411665,588.747824,215.257985,323.579975,147.512711,572.880441,115.377641,1405.543311,1402.626108,448.285623,794.380262,502.155354,439.344967,229.085137,160.798010,323.975308,283.520722,97.324200,115.377641,35.777088,80.000000,102.449988,57.688820,115.377641,137.637204,35.777088,178.885438,286.216701,326.337249,342.414953,210.447143,258.487911,298.904667,442.538134,232.963516,1131.370850,1795.496589,962.662973,48.000000,217.623528,342.040933,71.554175,97.324200,208.614477,240.000000,242.123935,128.996124,197.909070,71.554175,93.295230,160.000000,157.581725,107.331263,164.730082,80.000000,67.882251,131.939380,97.324200,35.777088,135.764502,124.963995,67.882251,147.512711,257.992248,151.789328,136.704060,164.730082,329.848450,107.331263,273.875884,158.391919,337.520370,627.477490,727.780187,396.141389,1354.341168,964.788060,364.856136,560.913541,1021.120953,834.764637,326.337249,678.822510,973.373515,727.252363,332.938433,144.886162,217.623528,202.385770,204.899976,65.969690,237.857100,107.331263,116.481758,32.000000,96.000000,65.969690,157.581725,32.000000,80.000000,81.584312,50.596443,48.000000,50.596443,35.777088,81.584312,128.996124,167.044904,102.449988,116.481758,57.688820,22.627417,50.596443,97.324200,80.000000,128.996124,50.596443,170.082333,65.969690,224.000000,498.317168,294.156421,603.138458,774.142106,236.237169,286.216701,195.304890,227.402726,67.882251,64.000000,204.899976,93.295230,295.025423,186.590461,65.969690,97.324200,80.000000,65.969690,48.000000,22.627417,16.000000,35.777088,96.000000,50.596443,16.000000,65.969690,50.596443,67.882251,97.324200,113.137085,124.963995,67.882251,80.000000,137.637204,96.000000,102.449988,50.596443,64.000000,57.688820,65.969690,48.000000,32.000000,16.000000,65.969690,57.688820,22.627417,16.000000,35.777088,22.627417,65.969690,65.969690,22.627417,0.000000,35.777088,32.000000,16.000000,64.000000,50.596443,32.000000,32.000000,32.000000,16.000000,35.777088,93.295230,101.192885,16.000000,71.554175,32.000000,57.688820,32.000000,50.596443,16.000000,35.777088,35.777088,57.688820,35.777088,16.000000,50.596443,50.596443,35.777088,50.596443,35.777088,50.596443,35.777088,35.777088,32.000000,35.777088,32.000000,16.000000,22.627417,16.000000,0.000000,57.688820,35.777088,22.627417,57.688820,22.627417,16.000000,32.000000,50.596443,16.000000,16.000000,45.254834,45.254834,22.627417,45.254834,16.000000,32.000000,35.777088,16.000000,16.000000,16.000000,22.627417,32.000000,35.777088,35.777088,16.000000,16.000000,35.777088,16.000000,45.254834,35.777088,0.000000,22.627417,0.000000,16.000000,16.000000,35.777088,22.627417,22.627417,35.777088,35.777088,16.000000,32.000000,22.627417,22.627417,35.777088,35.777088,0.000000,22.627417,16.000000,16.000000,45.254834,35.777088,0.000000,0.000000,16.000000,16.000000,22.627417,35.777088,16.000000,16.000000,16.000000,16.000000,32.000000,16.000000,22.627417,22.627417,35.777088,0.000000,32.000000,22.627417,57.688820,32.000000,16.000000,16.000000,22.627417,32.000000,16.000000,16.000000,35.777088,45.254834,0.000000,35.777088,32.000000,16.000000,0.000000,35.777088,35.777088,16.000000,0.000000,22.627417,16.000000,50.596443,48.000000,22.627417,32.000000,45.254834,35.777088,35.777088,16.000000,16.000000,22.627417,16.000000,22.627417,16.000000,22.627417,16.000000,0.000000,0.000000,16.000000,16.000000,32.000000,16.000000,22.627417,16.000000,16.000000,16.000000,16.000000,22.627417,16.000000,16.000000,32.000000,16.000000,45.254834,57.688820,0.000000,22.627417,35.777088,22.627417,22.627417,16.000000,0.000000,16.000000,16.000000,16.000000,22.627417,22.627417,22.627417,22.627417,35.777088,48.000000,0.000000,16.000000,0.000000,16.000000,35.777088,16.000000,16.000000,22.627417,16.000000,0.000000,16.000000,16.000000,0.000000,22.627417,57.688820,57.688820,32.000000,16.000000,32.000000,35.777088,16.000000,22.627417,0.000000,35.777088,16.000000,22.627417,16.000000,0.000000,0.000000,35.777088,32.000000,16.000000,22.627417,22.627417,16.000000,35.777088,35.777088,35.777088,57.688820,35.777088,16.000000,16.000000,50.596443,45.254834,35.777088,16.000000,16.000000,22.627417,32.000000,0.000000,16.000000,35.777088,16.000000,32.000000,22.627417,22.627417,16.000000,32.000000,32.000000,16.000000,35.777088,16.000000,22.627417,16.000000,0.000000,22.627417,16.000000,35.777088,16.000000,50.596443,35.777088,32.000000,35.777088,22.627417,32.000000,16.000000,16.000000,16.000000,32.000000,16.000000,0.000000,16.000000,35.777088,35.777088,35.777088,35.777088,22.627417,0.000000,35.777088,22.627417,16.000000,0.000000,16.000000,16.000000,32.000000,35.777088,22.627417,16.000000,0.000000,35.777088,16.000000,16.000000,16.000000,0.000000,22.627417,22.627417,22.627417,35.777088,22.627417,16.000000,16.000000,22.627417,22.627417,0.000000,22.627417,48.000000,16.000000,22.627417,22.627417,16.000000,16.000000,0.000000,35.777088,22.627417,16.000000,16.000000,16.000000,0.000000,22.627417,48.000000,35.777088,35.777088,16.000000,22.627417,0.000000,0.000000,16.000000,16.000000,16.000000,0.000000,22.627417,16.000000,16.000000,16.000000,0.000000,0.000000,0.000000,16.000000,22.627417,16.000000,22.627417,22.627417,16.000000,16.000000,16.000000,0.000000,22.627417,35.777088,35.777088,16.000000,32.000000,35.777088,50.596443,35.777088,22.627417,35.777088,16.000000,16.000000,35.777088,22.627417,35.777088,16.000000,16.000000,0.000000,22.627417,22.627417,16.000000,16.000000,0.000000,16.000000,22.627417,35.777088,35.777088,16.000000,35.777088,45.254834,45.254834,35.777088,0.000000,16.000000,22.627417,0.000000,16.000000,0.000000,0.000000,32.000000,32.000000,16.000000,16.000000,16.000000,0.000000,48.000000,22.627417,22.627417,22.627417,16.000000,16.000000,0.000000,0.000000,22.627417,16.000000,0.000000,16.000000,48.000000,16.000000,16.000000,16.000000,35.777088,45.254834,0.000000,22.627417,22.627417,0.000000,35.777088,16.000000,16.000000,32.000000,16.000000,16.000000,35.777088,32.000000,22.627417,22.627417,0.000000,0.000000,32.000000,16.000000,22.627417,22.627417,35.777088,0.000000,0.000000,16.000000,16.000000,35.777088,57.688820,32.000000,32.000000,50.596443,32.000000,22.627417,22.627417,16.000000,0.000000,32.000000,35.777088,16.000000,22.627417,35.777088,16.000000,16.000000,35.777088,22.627417,16.000000,0.000000,22.627417,35.777088,0.000000,0.000000,50.596443,57.688820,16.000000,32.000000,16.000000,22.627417,22.627417,22.627417,22.627417,16.000000,16.000000,0.000000,16.000000,0.000000,16.000000,16.000000,0.000000,0.000000,16.000000,16.000000,35.777088,22.627417,16.000000,0.000000,16.000000,16.000000,35.777088,35.777088,22.627417,32.000000,16.000000,0.000000,35.777088,32.000000,35.777088,32.000000,16.000000,0.000000,0.000000,16.000000,16.000000,16.000000,32.000000,22.627417,22.627417,16.000000,16.000000,0.000000,35.777088,22.627417,22.627417,16.000000,22.627417,16.000000,16.000000,22.627417,32.000000,16.000000,35.777088,22.627417,45.254834,35.777088,22.627417,16.000000,32.000000,50.596443,16.000000,35.777088,45.254834,16.000000,35.777088,57.688820,22.627417,16.000000,16.000000,16.000000,22.627417,22.627417,48.000000,35.777088,16.000000,48.000000,57.688820,32.000000,32.000000,35.777088,35.777088,0.000000,50.596443,50.596443,57.688820,16.000000,22.627417,45.254834,35.777088,57.688820,22.627417,93.295230,32.000000,101.192885,71.554175,16.000000,35.777088,22.627417,16.000000,22.627417,35.777088,32.000000,16.000000,45.254834,22.627417,22.627417,16.000000,57.688820,71.554175,16.000000,57.688820,0.000000,32.000000,57.688820,81.584312,0.000000,22.627417,50.596443,80.000000,71.554175,50.596443,45.254834,80.000000,97.324200,124.963995,65.969690,80.000000,102.449988,102.449988,112.000000,45.254834,45.254834,50.596443,16.000000,57.688820,97.324200,32.000000,16.000000,32.000000,57.688820,48.000000,97.324200,80.000000,48.000000,186.590461,283.520722,71.554175,195.304890,50.596443,57.688820,237.857100,186.590461,258.487911,214.662526,758.946638,603.138458,295.025423,509.242575,208.614477,50.596443,160.000000,65.969690,143.108351,124.963995,113.137085,57.688820,32.000000,67.882251,113.137085,93.295230,167.044904,124.963995,80.000000,22.627417,16.000000,35.777088,32.000000,65.969690,64.000000,35.777088,121.852370,96.000000,97.324200,50.596443,116.481758,121.852370,222.854212,80.000000,192.665513,200.479425,208.000000,163.168624,323.975308,715.004895,980.318316,690.228948,323.579975,838.283961,1017.605031,577.996540,332.938433,932.952303,1373.858799,396.141389,736.695324,618.022653,329.460165,181.019336,289.772324,93.295230,357.770876,193.328736,128.996124,164.730082,264.847126,143.108351,35.777088,143.108351,113.137085,48.000000,128.996124,113.137085,102.449988,80.000000,182.428068,86.162637,160.000000,124.963995,80.000000,50.596443,178.885438,121.852370,240.532742,237.857100,176.000000,71.554175,80.000000,323.579975,214.662526,65.969690,931.854066,1810.546879,1160.965116,252.982213,430.813185,323.975308,250.439613,229.085137,310.663805,345.392530,300.612708,144.886162,57.688820,147.512711,107.331263,65.969690,107.331263,45.254834,57.688820,121.852370,65.969690,303.578655,315.163450,160.000000,222.279104,436.715010,472.474338,758.946638,416.000000,1378.602191,1432.871243,136.704060,617.608290,135.764502,342.040933,208.614477,577.110041,822.717448,599.733274,50.596443,57.688820,232.963516,176.000000,35.777088,81.584312,57.688820,128.000000,136.704060,158.391919,81.584312,389.625461,307.766145,407.921561,644.980620,224.000000,163.168624,93.295230,116.481758,128.996124,45.254834,124.963995,147.512711,195.304890,65.969690,50.596443,288.000000,147.512711,97.324200,157.581725,131.939380,128.996124,32.000000,178.885438,236.237169,294.156421,182.428068,279.427987,107.331263,71.554175,257.992248,90.509668,237.857100,173.066461,135.764502,252.982213,32.000000,257.992248,195.304890,249.927990,377.613559,93.295230,573.550347,374.550397,661.440851,817.410546,770.662053,3272.303164,]
verilog_magnitudes_hardcoded_bfpexp_minus_6 = [511.984375,511.984375,0.000000,0.000000,2.519456,2.519456,0.000000,0.000000,0.366105,0.366105,0.000000,0.000000,0.843895,0.843895,0.000000,0.000000,0.758577,0.758577,0.000000,0.000000,0.367769,0.367769,0.000000,0.000000,0.594982,0.594982,0.000000,0.000000,0.362419,0.362419,0.000000,0.000000,0.500244,0.500244,0.000000,0.000000,0.237993,0.237993,0.000000,0.000000,0.212523,0.212523,0.000000,0.000000,0.100049,0.100049,0.000000,0.000000,0.260052,0.260052,0.000000,0.000000,0.174693,0.174693,0.000000,0.000000,0.254357,0.254357,0.000000,0.000000,0.217631,0.217631,0.000000,0.000000,0.727696,0.727696,0.000000,0.000000,0.975531,0.975531,0.000000,0.000000,0.474445,0.474445,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.104816,0.104816,0.000000,0.000000,0.110485,0.110485,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.066291,0.066291,0.000000,0.000000,0.983879,0.983879,0.000000,0.000000,0.141490,0.141490,0.000000,0.000000,0.044194,0.044194,0.000000,0.000000,0.093750,0.093750,0.000000,0.000000,0.095043,0.095043,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.078125,0.078125,0.000000,0.000000,0.066291,0.066291,0.000000,0.000000,0.188150,0.188150,0.000000,0.000000,0.391873,0.391873,0.000000,0.000000,0.441942,0.441942,0.000000,0.000000,0.069877,0.069877,0.000000,0.000000,0.478033,0.478033,0.000000,0.000000,0.069877,0.069877,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.104816,0.104816,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.046875,0.046875,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.049411,0.049411,0.000000,0.000000,0.079672,0.079672,0.000000,0.000000,0.049411,0.049411,0.000000,0.000000,0.174693,0.174693,0.000000,0.000000,0.046875,0.046875,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.049411,0.049411,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.046875,0.046875,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.034939,0.034939,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.031250,0.031250,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.049411,0.049411,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.046875,0.046875,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.022097,0.022097,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000,0.015625,0.015625,0.000000,0.000000]

verilog_magnitudes = verilog_magnitudes[:FFT_SIZE//2]
verilog_magnitudes_hardcoded_bfpexp_4 = verilog_magnitudes_hardcoded_bfpexp_4[:FFT_SIZE//2]
verilog_magnitudes_hardcoded_bfpexp_minus_5 = verilog_magnitudes_hardcoded_bfpexp_minus_5[:FFT_SIZE//2]
verilog_magnitudes_hardcoded_bfpexp_minus_6 = verilog_magnitudes_hardcoded_bfpexp_minus_6[:FFT_SIZE//2]
x = fftfreq(1024, 1/SAMPLING_RATE)[:FFT_SIZE//2]

max_frequencies_verilog_fft = plot_FFT(verilog_magnitudes, x, "ORIGINAL FFT VERILOG ALGORITHM");
max_frequencies_verilog_fft_hardcoded_bfexp_4 = plot_FFT(verilog_magnitudes_hardcoded_bfpexp_4, x, "FFT VERILOG ALGORITHM (modified hardcoded 4)");
max_frequencies_verilog_fft_hardcoded_bfexp_minus_5 = plot_FFT(verilog_magnitudes_hardcoded_bfpexp_minus_5, x, "CUSTOM VERILOG ALGORITHM (exp = -5)");
max_frequencies_verilog_fft_hardcoded_bfexp_minus_6 = plot_FFT(verilog_magnitudes_hardcoded_bfpexp_minus_6, x, "CUSTOM VERILOG ALGORITHM (exp = -6)");

# print("MAX FREQUENCIES DETECTED BY VERILOG (normal bfp):", max_frequencies_verilog_fft)
# print("MAX FREQUENCIES DETECTED BY VERILOG (bfp = 4):", max_frequencies_verilog_fft_hardcoded_bfexp_4)
print("MAX FREQUENCIES DETECTED BY CUSTOM VERILOG (bfp = -6):", max_frequencies_verilog_fft_hardcoded_bfexp_minus_6)
